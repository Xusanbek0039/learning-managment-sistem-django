{% extends 'accounts/base.html' %}
{% load widget_tweaks %}

{% block title %}
{% if form.instance.pk %}Mahsulotni tahrirlash{% else %}Yangi mahsulot{% endif %} - Admin | IT Creative
{% endblock %}

{% block extra_css %}
<style>
:root{
    --card-bg: rgba(255,255,255,.8);
    --card-border: rgba(0,0,0,.08);
    --text-main: #111;
    --soft-bg: rgba(0,0,0,.05);
}
[data-bs-theme="dark"]{
    --card-bg: rgba(18,18,18,.85);
    --card-border: rgba(255,255,255,.08);
    --text-main: #f1f1f1;
    --soft-bg: rgba(255,255,255,.06);
}

/* ===== IOS CARD ===== */
.ios-card{
    background:var(--card-bg);
    backdrop-filter:blur(14px);
    border:1px solid var(--card-border);
    border-radius:24px;
    box-shadow:0 14px 40px rgba(0,0,0,.2);
}

/* ===== INPUTS ===== */
.form-control, .form-select{
    border-radius:14px;
}
.form-check-input{
    border-radius:6px;
}

/* ===== IMAGE ===== */
.preview-img{
    max-height:150px;
    border-radius:14px;
    object-fit:cover;
}

/* ===== BUTTONS ===== */
.ios-btn{
    border-radius:14px;
    font-weight:600;
}
</style>
{% endblock %}

{% block content %}
<div class="container my-4 my-md-5">

<div class="row justify-content-center">
<div class="col-lg-8">



<div class="ios-card p-4 p-md-5">

<h4 class="fw-bold mb-4">
<i class="bi bi-{% if form.instance.pk %}pencil{% else %}plus-circle{% endif %} me-2"></i>
{% if form.instance.pk %}Mahsulotni tahrirlash{% else %}Yangi mahsulot qo‘shish{% endif %}
</h4>

<form method="post" enctype="multipart/form-data">
{% csrf_token %}

<!-- NAME -->
<div class="mb-4">
<label class="form-label fw-semibold">Mahsulot nomi</label>
<input type="text" name="name"
       class="form-control {% if form.name.errors %}is-invalid{% endif %}"
       value="{{ form.name.value|default:'' }}"
       placeholder="Mahsulot nomi">
{% if form.name.errors %}
<div class="invalid-feedback">{{ form.name.errors.0 }}</div>
{% endif %}
</div>

<!-- DESCRIPTION -->
<div class="mb-4">
<label class="form-label fw-semibold">Tavsif</label>
<textarea name="description" rows="5"
          class="form-control {% if form.description.errors %}is-invalid{% endif %}"
          placeholder="Mahsulot tavsifi">{{ form.description.value|default:'' }}</textarea>
{% if form.description.errors %}
<div class="invalid-feedback">{{ form.description.errors.0 }}</div>
{% endif %}
</div>

<!-- IMAGE -->
<div class="mb-4">
<label class="form-label fw-semibold">Rasm</label>

{% if form.instance.image %}
<div class="mb-2">
<img src="{{ form.instance.image.url }}" class="preview-img">
<small class="text-muted d-block mt-1">Joriy rasm</small>
</div>
{% endif %}

<input type="file" name="image" class="form-control" accept="image/*">
{% if form.image.errors %}
<div class="text-danger small mt-1">{{ form.image.errors.0 }}</div>
{% endif %}
</div>

<!-- PRICE & STOCK -->
<div class="row mb-4">

<div class="col-md-6 mb-3 mb-md-0">
<label class="form-label fw-semibold">Narxi (coin)</label>
<input type="number" name="coin_price" min="1"
       class="form-control {% if form.coin_price.errors %}is-invalid{% endif %}"
       value="{{ form.coin_price.value|default:'' }}">
{% if form.coin_price.errors %}
<div class="invalid-feedback">{{ form.coin_price.errors.0 }}</div>
{% endif %}
</div>

<div class="col-md-6">
<label class="form-label fw-semibold">Zaxira</label>
<input type="number" name="stock" min="0"
       class="form-control {% if form.stock.errors %}is-invalid{% endif %}"
       value="{{ form.stock.value|default:'' }}">
{% if form.stock.errors %}
<div class="invalid-feedback">{{ form.stock.errors.0 }}</div>
{% endif %}
</div>

</div>

<!-- ACTIVE -->
<div class="mb-4">
<div class="form-check">
<input class="form-check-input" type="checkbox" name="is_active"
       {% if form.instance.is_active or not form.instance.pk %}checked{% endif %}>
<label class="form-check-label fw-semibold">
Faol (marketda ko‘rinadi)
</label>
</div>
</div>

<!-- BUTTONS -->
<div class="d-flex gap-3 flex-wrap">

<a href="{% url 'admin_products' %}"
   class="btn btn-outline-secondary ios-btn px-4">
<i class="bi bi-arrow-left me-2"></i>Bekor
</a>

<button type="submit" class="btn btn-primary ios-btn px-4 flex-grow-1">
<i class="bi bi-check-lg me-2"></i>
{% if form.instance.pk %}Saqlash{% else %}Qo‘shish{% endif %}
</button>

</div>

</form>

</div>

</div>
</div>

</div>
{% endblock %}

{% extends 'accounts/base.html' %}

{% block title %}Profilni tahrirlash | LMS - IT Creative{% endblock %}

{% block extra_css %}
<style>

/* ===== THEME ===== */
.edit-wrap{--border:rgba(0,0,0,.08);--shadow:0 15px 40px rgba(0,0,0,.12)}
[data-bs-theme="dark"] .edit-wrap{--border:rgba(255,255,255,.12);--shadow:0 30px 70px rgba(0,0,0,.7)}

/* ===== CARD ===== */
.edit-card{
    background:var(--bs-body-bg);
    border:1px solid var(--border);
    border-radius:1.5rem;
    box-shadow:var(--shadow);
}

/* ===== AVATAR ===== */
.edit-avatar{
    width:120px;height:120px;border-radius:50%;
    object-fit:cover;border:4px solid rgba(99,102,241,.4)
}
.edit-avatar-fallback{
    width:120px;height:120px;border-radius:50%;
    background:linear-gradient(135deg,#6366f1,#8b5cf6);
    display:flex;align-items:center;justify-content:center;
    color:#fff;font-size:2.5rem;font-weight:700
}

/* ===== INPUT ===== */
.form-control, .form-select{
    border-radius:1rem
}
.form-control:focus, .form-select:focus{
    box-shadow:0 0 0 .15rem rgba(99,102,241,.25)
}

/* ===== FILE ===== */
input[type=file]{border-radius:1rem}

/* ===== BUTTON ===== */
.action-btn{border-radius:2rem;font-weight:600;padding:.5rem 1.6rem}

</style>
{% endblock %}

{% block content %}
<div class="container py-5 edit-wrap">

<div class="row justify-content-center">
<div class="col-lg-9 col-md-10">

<a href="{% url 'profile' %}" class="btn btn-outline-secondary rounded-pill mb-4">
    <i class="bi bi-arrow-left me-1"></i>Orqaga
</a>

<div class="edit-card p-4 p-lg-5">

<h4 class="fw-bold mb-4 text-primary">
    <i class="bi bi-pencil-square me-2"></i>Profilni tahrirlash
</h4>

<form method="POST" enctype="multipart/form-data">
{% csrf_token %}

<!-- AVATAR -->
<div class="text-center mb-4">

{% if user.photo %}
    <img src="{{ user.photo.url }}" class="edit-avatar mb-2">
{% else %}
    <div class="edit-avatar-fallback mb-2">{{ user.get_initials }}</div>
{% endif %}

<div class="mt-2">
    {{ form.photo }}
</div>

</div>

<!-- NAME -->
<div class="row g-3">

<div class="col-md-6">
    <label class="form-label">Ism</label>
    {{ form.first_name }}
</div>

<div class="col-md-6">
    <label class="form-label">Familiya</label>
    {{ form.last_name }}
</div>

<div class="col-md-6">
    <label class="form-label">Telefon</label>
    {{ form.phone }}
</div>

<div class="col-md-6">
    <label class="form-label">Email</label>
    {{ form.email }}
</div>

<div class="col-md-6">
    <label class="form-label">Yashash manzili</label>
    {{ form.address }}
</div>

<div class="col-md-6">
    <label class="form-label">Tug'ilgan sana</label>
    {{ form.birth_date }}
</div>

</div>

<!-- FILES -->
<div class="row g-3 mt-2">

<div class="col-md-6">
    <label class="form-label">ID karta / Pasport</label>
    {{ form.id_card }}
    {% if user.id_card %}
        <small class="text-muted d-block mt-1">
            Joriy fayl: <a href="{{ user.id_card.url }}" target="_blank">Ko'rish</a>
        </small>
    {% endif %}
</div>

<div class="col-md-6">
    <label class="form-label">Tug'ilganlik guvohnomasi</label>
    {{ form.birth_certificate }}
    {% if user.birth_certificate %}
        <small class="text-muted d-block mt-1">
            Joriy fayl: <a href="{{ user.birth_certificate.url }}" target="_blank">Ko'rish</a>
        </small>
    {% endif %}
</div>

</div>

<!-- BIO -->
<div class="mt-3">
    <label class="form-label">O'zingiz haqida</label>
    {{ form.bio }}
</div>

<!-- ACTIONS -->
<div class="d-flex gap-3 mt-4">

<button type="submit" class="btn btn-primary action-btn">
    <i class="bi bi-check-lg me-1"></i>Saqlash
</button>

<a href="{% url 'profile' %}" class="btn btn-outline-secondary action-btn">
    Bekor qilish
</a>

</div>

</form>

</div>

</div>
</div>
</div>
{% endblock %}
